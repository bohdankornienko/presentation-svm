<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Support Vector Machines</title>

		<meta name="description" content="A presentation about Support Vector Machines">
		<meta name="author" content="Bohdan Kornienko">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<link rel="stylesheet" href="reveal_js/css/reset.css">
		<link rel="stylesheet" href="reveal_js/css/reveal.css">
		<link rel="stylesheet" href="reveal_js/css/theme/black.css" id="theme">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="reveal_js/lib/css/monokai.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'reveal_js/css/print/pdf.css' : 'reveal_js/css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
        <style type="text/css">
            .reveal h1 {
                font-size: larger;
            }

            .reveal h2 {
                font-size: smaller;
                text-transform: none;
            }

            div.block {
                border: 1px solid white;
                border-radius: 10px;
                margin: 10px;
                display: inline-block;
                padding: 5px;
                padding-left: 10px;
                padding-right: 10px;
                background-color: rgba(0,0,0, 0.2);

            }
            .reveal blockquote {
                width: 100%;
            }

            .reveal blockquote span.author {
                position: relative;
                display: block;
                font-size: smaller;
                text-align: right;
                margin-top: 5px;
                color: #999;

                i {
                    position: relative;
                    background: #eee;
                    padding-left: 5px;
                    font-style: italic;
                    z-index: 5;
                }
            }

            a.note {
                font-size: 20%;
                display: block;
            }

            div.block {
                border: 1px solid white;
                border-radius: 10px;
                margin: 10px;
                display: inline-block;
                padding: 5px;
                padding-left: 10px;
                padding-right: 10px;
                background-color: rgba(0,0,0, 0.2);
            }
        </style>
         <style type="text/css">
                    table, th, td {
                      border: 1px solid white;
                    }
                </style>
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
                <section>
                    <h1>Support Vector Machines</h1>
                </section>

                <section>
                    <div class="block">CS BA</div>
                    <div class="block">C++</div>
                    <div class="block">Data Science</div>
                    <hr>
                    <div class="block">Drawing</div>
                    <div class="block">Khan Academy</div>
                    <div class="block">Driving</div>
                </section>

                <section>
                    <section>
                        <h1>The Problem</h1>
                        <p>Letâ€™s say we want to solve the housing selling problem.</p>
                        <p>I.e. using the <b>set of features</b> we want to predict whether house will be <b>sold or not</b>.</p>
                    </section>
                    <section>
                        <p>The features might be:</p>   
                        <ul>
                            <li>House size (area)</li>
                            <li>Number of rooms</li>
                            <li>Year built</li>
                            <li>etc.</li>
                        </ul>
                    </section>
                </section>

                <section>
                    <img class="stretch" src="images/liner-separable-base.png">
                </section>

                <section>
                        <h1>Approach</h1>
                        <p>One way to solve the broblem is to use<br><b>Logistic regression</b></p>
                </section>

                <section>
                    <h5>How probably Logistic Regression will work</h5>
                    <!-- 
                    <img width="31%" src="images/liner-separable-db-1.png">
                    <img width="31%" src="images/liner-separable-db-2.png">
                    <img width="31%" src="images/liner-separable-db-3.png">
                    -->
                    <img class="stretch" src="images/liner-separable-db-sequence.png">
                </section>

                <section>
                    <section>
                        <h1>Is it good for us?</h1>
                    </section>

                    <section>
                        <img class="stretch" src="images/liner-separable-lr-db-test.png">
                    </section>
                    <section>
                        <img class="stretch" src="images/liner-separable-lr-db-test-2.png">
                    </section>
                </section>

                <section>
                    <img class="stretch" src="images/liner-separable-lr-db-options.png">
                </section>

                <section>
                    <h1>Intuition</h1>
                    <img class="stretch" src="images/liner-separable-lr-db-best-split.png">
                </section>

                <section>
                    <h1>The SVM</h1>
                    <img class="stretch" src="images/liner-separable-lr-db-svm.png">
                </section>

                <section>
                    <img class="stretch" src="images/liner-separable-lr-db-svm-margin.png">
                </section>

                <section>
                    <section>
                        <h1>Definitions</h1>
                        <img class="stretch" src="images/liner-separable-lr-db-svm-clear.png">
                        
                        <script type="math/tex; mode=display">
                            w^T x + b = 0, y \in \{-1, +1\}
                        </script>
                    </section>

                    <section>
                        <h1>Gamma +1</h1>
                        <img class="stretch" src="images/liner-separable-lr-db-svm-gammas.png">
                        
                        <script type="math/tex; mode=display">
                            \gamma^{(i)} = \left(\frac{w}{||w||}\right)^T x^{(i)} + \frac{b}{||w||}
                        </script>
                    </section>

                    <section>
                        <h1>Gamma -1</h1>
                        <img class="stretch" src="images/liner-separable-lr-db-svm-gammas.png">
                        
                        <script type="math/tex; mode=display">
                            \DeclareMathOperator*{\argmax}{argmax}
                            \gamma^{(i)} = y^{(i)}\left(\left(\frac{w}{||w||}\right)^T x^{(i)} + \frac{b}{||w||}\right)
                        </script>
                    </section>
                    <section>
                        <p>We optimize SVM such that &gamma; is &#8805; 1</p>
                    </section>
                    <section>
                        <h1>Support Vectors</h1> 
                        <script type="math/tex; mode=display">
                            \gamma = 1
                        </script>  
                        <img class="stretch" src="images/liner-separable-lr-db-svm-gammas.png">
                    </section>
                </section>

                <section>
                    <section>
                        <h1>Objective</h1>
                        <script type="math/tex; mode=display">
                            \argmax_{w, b} \gamma
                        </script>
                        <p>Constraints:</p>
                        <script type="math/tex; mode=display">
                                y^{(i)}(w^T x^{(i)} + b) \ge \gamma, \;\;\;i = 1,..,m \\
                                ||w|| = 1
                        </script>
                    </section>

                    <section>
                        <h1>Objective as minimization</h1>
                        <script type="math/tex; mode=display">
                            \DeclareMathOperator*{\argmin}{argmin}
                            \argmin_{w, b} \frac{1}{2} ||w||^2
                        </script>
                        <p>Constraints:</p>
                        <script type="math/tex; mode=display">
                                y^{(i)}(w^T x^{(i)} + b) \ge 1, \;\;\;i = 1,..,m \\
                        </script>
                    </section>
                </section>

                <section>
                    <h1>Hard-margin</h1>
                    <img class="stretch" src="images/liner-separable-lr-db-svm-clear.png">
                </section>

                <section>
                    <section>
                        <h1>Outliers</h1>
                        <img class="stretch" src="images/svm-outlier.png">
                    </section>
                    <section>
                        <h1>Data is linearly inseparable</h1>
                        <img class="stretch" src="images/svm-non-splittable.png">
                    </section>
                </section>

                <section>
                    <section>
                        <h1>Introducing C term</h1>
                        <script type="math/tex; mode=display">
                            \DeclareMathOperator*{\argmin}{argmin}
                            \argmin_{w, b} \frac{1}{2} ||w||^2 + C (\text{# of mistakes})
                        </script>
                    </section>

                    <section>
                        <p>The error will be represented by simbol &xi;.</p>
                    </section>

                    <section>
                        <img class="stretch" src="images/xi.png">
                        <p>The value of &xi; is the distance of x from the corresponding classâ€™s margin.</p>
                    </section>
                    <section>
                        <p>C is the trade-off between maximizing the margin and minimizing the mistakes</p>
                        <p>C is small - errors are less important</p>
                        <p>C is large - we avoid mistakes as much as possible</p>
                    </section>

                    <section>
                        <h1>Objective</h1>
                        <script type="math/tex; mode=display">
                            \DeclareMathOperator*{\argmin}{argmin}
                            \argmin_{\gamma, w, b} \frac{1}{2} ||w||^2 + C \sum_{i=1}^{n} \xi_i
                        </script>
                        <p>Constraints:</p>
                        <script type="math/tex; mode=display">
                                y^{(i)}(w^T x^{(i)} + b) \ge 1 - \xi, \;\;\;i = 1,..,m \\
                                \xi_i \ge 0
                        </script>
                    </section>

                    <section>
                        <h1>Soft-margin</h1>
                        <img class="stretch" src="images/xi.png">
                    </section>
                </section>

                <section>
                    <section>
                        <h1>Non-linear cases</h1>
                    </section>

                    <section>
                        <img class="stretch" src="images/non-linear-data.png">
                    </section>

                    <section>
                        <img class="stretch" src="images/non-linear-data.png">
                        <script type="math/tex; mode=display">
                            w_0 + w_1 x_1 + w_2 x_2 + w_3 x_1 x_2 + w_4 x_1^2 + w_5 x_2^2 + ... \ge 1
                        </script>
                    </section>

                    <section>
                        <script type="math/tex; mode=display">
                            h(x, w) = w_0 + w_1 x_1 + w_2 x_2 + w_3 x_1 x_2 + w_4 x_1^2 + w_5 x_2^2
                        </script>
                        <p>Replace with</p>
                        <script type="math/tex; mode=display">
                            h(x, w) = w_0 + w_1 f_1 + w_2 f_2 + w_3 f_3 + w_4 f_4 + w_5 f_5
                        </script>
                    </section>

                    <section>
                        <script type="math/tex; mode=display">
                            h(x, w) = w_0 + w_1 f_1 + w_2 f_2 + w_3 f_3 + w_4 f_4 + w_5 f_5
                        </script>

                        <script type="math/tex; mode=display">
                            f_1 = x_1, f_2 = x_2, f_3 = x_1 x_2, f_4 = x_1^2, f_5 = x_2^2
                        </script>
                    </section>

                    <section>
                        <img class="stretch" src="images/non-linear-data-landmarks.png">
                    </section>

                    <section>
                        <h1>Similarity function</h1>
                        <script type="math/tex; mode=display">
                            f_i = similarity(x, l^{(i)})
                        </script>
                    </section>

                    <section>
                        <h1>Similarity function</h1>
                        <p>A measure how two points close to each other.</p>
                    </section>

                    <section>
                        <p>Let features be:</p>
                        <p>f1 = how close to landmark 1</p>
                        <p>f2 = how close to landmark 2</p>
                        <p>f3 = how close to landmark 3</p>
                    </section>

                    <section>
                        <script type="math/tex; mode=display">
                            h(w, x) = w_0 + w_1 f_1 + w_2 f_2 + w_3 f_3
                        </script>
                    </section>

                    <section>
                        <img class="stretch" src="images/non-linear-data-landmarks-dists.png">
                    </section>

                    <section>
                        <script type="math/tex; mode=display">
                            f_1(x, l^{(1)}) = 0.6
                        </script>
                        <script type="math/tex; mode=display">
                            f_2(x, l^{(2)}) = 0.5
                        </script>
                        <script type="math/tex; mode=display">
                            f_1(x, l^{(3)}) = 1.0
                        </script>
                    </section>

                    <section>
                        <img class="stretch" src="images/non-linear-data-full-and-landmarks.png">
                    </section>

                    <section>
                        <img class="stretch" src="images/non-linear-data-full-and-landmarks-db.png">
                    </section>

                    <section>
                        <h1>How to choose landmarks</h1>
                    </section>

                    <section>
                        <p>Usually the strategy is to make each sample in train set as a landmark.</p>
                        <p>As a result SVM will have number of features equal to number of samples.</p>
                    </section>
                </section>

                <section>
                    <section>
                        <h1>Kernels</h1>
                        <p>The similarity functions are called <b>Kernels</b></p>
                    </section>
                    <section>
                        <h1>Gaussian Kernel</h1>
                        <script type="math/tex; mode=display">
                            exp\left(-\frac{||x-l^{(i)}||^2}{2\sigma^2}\right)
                        </script>
                    </section>

                    <section>
                        <img class="stretch" src="images/sigmas.png">                
                    </section>

                    <section>
                        <h1>Other Kernels</h1>
                    </section>

                    <section>
                        <h1>Linear</h1>
                        <script type="math/tex; mode=display">
                            \langle x, x' \rangle
                        </script>
                    </section>
                    <section>
                        <h1>Polynomial</h1>
                        <script type="math/tex; mode=display">
                            (\gamma\langle x, x' \rangle + r)^d
                        </script>
                    </section>
                    <section>
                        <h1>rbf</h1>
                        <script type="math/tex; mode=display">
                            exp(-\gamma||x - x'||^2)
                        </script>
                    </section>
                    <section>
                        <h1>Sigmoid</h1>
                        <script type="math/tex; mode=display">
                            tanh(\gamma\langle x, x' \rangle + r)
                        </script>
                    </section>
                </section>

                <section>
                    <section><h1>Bias\variance tradeoff</h1></section>
                    <section>
                        <h1>C</h1>
                        <p>Large C: lower bias, high variance</p>
                        <p>Small C: Higher bias, lower variance</p>
                    </section>

                    <section>
                        <h1>Large Sigma</h1>
                        <p>Features vary more smoothly</p>
                        <p>Higher bias, lower variance</p>
                    </section>
                    <section>
                        <h1>Small Sigma</h1>
                        <p>Features vary less smoothly</p>
                        <p>Lower bias, higher variance</p>
                    </section>
                </section>

                <section>
                    <section>
                        <h1>Gaussian kernel usage</h1>
                        <script type="math/tex; mode=display">
                            ||x - l||^2 = (x_1 - l_1)^2 + (x_1 - l_1)^2 + ... + (x_n - l_n)^2
                        </script>
                        <p>If x<sub>1</sub>=1000 and x<sub>2</sub>=5, x<sub>1</sub> will suppress x<sub>2</sub></p>
                    </section>

                    <section>
                        <p>Apply feature scaling</p>
                    </section>
                </section>

                <section>
                    <h1>Practical Guide to SVM</h1>
                    <ul>
                        <li>Procedure</li>
                        <li>Data Processing</li>
                        <li>Model Selection</li>
                        <li>etc.</li>
                    </ul>
                </section>

                <section><h1>References</h1>
                    <ul>
                        <li><a href="http://cs229.stanford.edu/notes/cs229-notes3.pdf">CS229 Notes</a></li>
                        <li><a href="https://www.youtube.com/playlist?list=PLLssT5z_DsK-h9vYZkQkYNWcItqhlRJLN">Andrew Ng's ML course, sections 12</a></li>
                        <li><a href="https://en.wikipedia.org/wiki/Lagrange_multiplier">Lagrange Multiplier</a></li>
                        <li><a href="http://www.robots.ox.ac.uk/~az/lectures/ml/lect3.pdf">One more presentation on SVM</a></li>
                        <li><a href="https://towardsdatascience.com/support-vector-machines-soft-margin-formulation-and-kernel-trick-4c9729dc8efe">SVM on Medium</a></li>
                        <li><a href="https://en.wikipedia.org/wiki/Support-vector_machine#Linear_SVM">Support Vector Machines, wiki</a></li>
                        <li><a href="https://www.csie.ntu.edu.tw/~cjlin/papers/guide/guide.pdf">Practical Guide to SVM</a></li>
                    </ul>
                </section>

                <section>
                    <h1>Cheers!</h1>
                </section>

                <section>
                    <img class="stretch" src="images/qr_link.png">
                </section>

			</div>

		</div>

		<script src="reveal_js/js/reveal.js"></script>

		<script>

			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				center: true,
				hash: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: 'reveal_js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'reveal_js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'reveal_js/plugin/highlight/highlight.js', async: true },
					{ src: 'reveal_js/plugin/search/search.js', async: true },
					{ src: 'reveal_js/plugin/zoom-js/zoom.js', async: true },
					{ src: 'reveal_js/plugin/notes/notes.js', async: true },
                    { src: 'reveal_js/plugin/math/math.js', async: true }
				]
			});

		</script>
	</body>
</html>
